/*!
 
 (c) 2022 impleCode - https://implecode.com
 */
function ic_register_block(Ee,e,r){const Ne=window.wp.blocks;const t=window.wp.blockEditor;const a=window.wp.element;const l=window.wp.components;const Be=window.wp.serverSideRender;const Oe=window.wp.htmlEntities.decodeEntities;var Te=a.createElement;var Re=t.InspectorControls;var Qe=l.SelectControl;var Fe=l.TextControl;var Le=l.RadioControl;var De=l.Spinner;var Me=l.Notice;var qe=l.ToggleControl;var ze=l.CheckboxControl;var Ge=l.SearchControl;var He=l.Panel;var Je=l.PanelBody;var Ke=l.PanelRow;var Ue=t.AlignmentToolbar;var Ve=l.ToolbarButton;var We=t.BlockControls;var Xe=t.useBlockProps;var Ye=a.useState;var Ze=[];var $e=Ee.split("/");$e=$e[1];var s={};if(r!==undefined){s.from=[{type:"block",blocks:["core/legacy-widget"],isMatch:({idBase:e,instance:t})=>{if(t.raw===undefined){return false}return e===r},transform:({instance:e})=>{return Ne.createBlock(Ee,e.raw)}}]}Ne.registerBlockType(Ee,{transforms:s,usesContext:e,edit:function(s){const o=s.attributes;const e=Ne.getBlockSupport(Ee,"ic_fields");const[n,i]=Ye(false);function t(e){s.setAttributes({title:e})}function r(e){s.setAttributes({shortcode_support:e})}function a(e){s.setAttributes({dropdown:e})}function l(e){s.setAttributes({count:e})}function c(e){s.setAttributes({hierarchical:e})}function u(e,t,r){if(Array.isArray(o.selectedCategory)){if(t!==undefined){var a=false;var l=rt(o);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedCategory:l})}if(o.category.length){s.setAttributes({category:[]})}if(l.length&&o.selectedProduct!==undefined&&o.selectedProduct.length){s.setAttributes({selectedProduct:[]})}}else{s.setAttributes({category:e})}}else{s.setAttributes({category:e})}}function d(e){s.setAttributes({orderby:e})}function p(e){s.setAttributes({order:e})}function f(e){s.setAttributes({archive_template:e})}function g(e){s.setAttributes({per_row:e})}function h(e){s.setAttributes({no_add_to_cart:e})}function b(e,t,r){if(Array.isArray(o.selectedProduct)){if(t!==undefined){var a=false;var l=tt(o);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedProduct:l})}if(o.product!==undefined&&o.product.length){s.setAttributes({product:[]})}if(l.length&&o.selectedCategory!==undefined&&o.selectedCategory.length){s.setAttributes({selectedCategory:[]})}}}else{s.setAttributes({selectedProduct:parseInt(e,10)});if(n){i(false)}}}function _(e){s.setAttributes({alignment:e===undefined?"none":e})}function y(e){s.setAttributes({productSearch:e===undefined?"":e})}function v(e){s.setAttributes({categorySearch:e===undefined?"":e})}function k(e){s.setAttributes({productFromContext:e});if(e){if(o.product!==undefined&&o.product.length){s.setAttributes({product:[]})}if(o.category!==undefined&&o.category.length){s.setAttributes({product:[]})}if(o.selectedCategory!==undefined&&o.selectedCategory.length){s.setAttributes({selectedCategory:[]})}if(o.selectedProduct!==undefined){if(Array.isArray(o.selectedProduct)&&o.selectedProduct.length){s.setAttributes({selectedProduct:[]})}else{s.setAttributes({selectedProduct:0})}}if(o.categorySearch!==undefined&&o.categorySearch.length){s.setAttributes({categorySearch:""})}if(o.productSearch!==undefined&&o.productSearch.length){s.setAttributes({productSearch:""})}}}function m(e,t){s.setAttributes({[e]:t})}var A=[];var w=[];var C=[];var j={};var x=false;var I=[];var P=et(o);s.attributes.ic_context_id=ic_blocks_js_global.context.id;s.attributes.ic_context_post_type=ic_blocks_js_global.context.type;var S=Te(Be,{key:$e+"-server-side-renderer",block:Ee,attributes:s.attributes});var E=S;if(o.title!==undefined){var N=o.title;w.push(Te(Fe,{label:ic_blocks_js_global.strings.select_title,value:N,key:$e+"-title",type:"text",onChange:t}))}if(o.shortcode_support!==undefined){var B=o.shortcode_support;w.push(Te(ze,{label:ic_blocks_js_global.strings.select_shortcode_support,value:"1",key:$e+"-shortcode-support",checked:B,type:"checkbox",onChange:r}))}if(o.dropdown!==undefined){var O=false;if(o.dropdown){O=true}w.push(Te(ze,{label:ic_blocks_js_global.strings.select_dropdown,value:"1",key:$e+"-dropdown",checked:O,type:"checkbox",onChange:a}))}if(o.count!==undefined){var T=false;if(o.count){T=true}w.push(Te(ze,{label:ic_blocks_js_global.strings.select_count,value:"1",key:$e+"-count",checked:T,type:"checkbox",onChange:l}))}if(o.hierarchical!==undefined){var R=false;if(o.hierarchical){R=true}w.push(Te(ze,{label:ic_blocks_js_global.strings.select_hierarchical,value:"1",key:$e+"-hierarchical",checked:R,type:"checkbox",onChange:c}))}if(o.category!==undefined||o.selectedCategory!==undefined){var Q=rt(o);var F=[];var L=P.categories;var D=P.selected_categories;var M=[];if(L){if(D){D.forEach(e=>{if(e.value!==undefined){M.push(parseInt(e.value,10));if(e.value!==0){F.push({value:parseInt(e.value,10),label:Oe(e.label)})}}else{M.push(parseInt(e.id,10));if(e.id!==0){F.push({value:parseInt(e.id,10),label:Oe(e.name)+" ("+e.count+")"})}}})}L.forEach(e=>{if(!M.includes(parseInt(e.id,10))){F.push({value:parseInt(e.id,10),label:Oe(e.name)+" ("+e.count+")"})}})}var q="";var z=[];var G=[];var H="";if(o.categorySearch!==undefined){H=o.categorySearch;z.push(Te(Ge,{label:ic_blocks_js_global.strings.search_category,value:H,type:"string",key:$e+"-search-category",placeholder:ic_blocks_js_global.strings.category_search_placeholder,onChange:v}));F.forEach(t=>{G.push(Te(Ke,{key:$e+"-checkbox-row-category-"+t.value},Te(ze,{label:t.label,checked:M.includes(t.value),value:t.value,key:$e+"-checkbox-category-"+t.value,onChange:function(e){u(e,t.value,t.label)}})))})}else{G.push(Te(Ke,{key:$e+"-category-select-panel-row"},Te(Qe,{multiple:"multiple",label:"",key:$e+"-category-select",value:Q,options:F,onChange:u})))}if(F.length===0){if(P.ready){if(H){z.push(Te(Me,{key:$e+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword."))}}else{G.push(Te(De,{key:$e+"category-selector-loading"}))}}var J=Te(Je,{title:ic_blocks_js_global.strings.select_categories,key:$e+"-category-select-panel-body",className:"ic-panel-body",initialOpen:Q},G);if(G.length===0){J=""}C.push(J);var K=ic_blocks_js_global.strings.choose_categories;if(o.selectedProduct!==undefined){K=ic_blocks_js_global.strings.by_category}var U="ic-panel-body";if(!H&&(F.length<5||F.length===0)){U="ic-hidden-panel-body"}if(z.length){q=Te(Je,{title:ic_blocks_js_global.strings.search_category,key:$e+"-search-category-panel-body",className:U,initialOpen:true},z)}var V=Te(He,{header:K,key:$e+"-main-panel"},q,J);if(Q.length===0){if(I.length===0){x=true}}else{x=false}I.push(V)}if(o.orderby!==undefined){var W=o.orderby;var X=ic_blocks_js_global.category_orderby_options;w.push(Te(Qe,{label:ic_blocks_js_global.strings.select_orderby,value:W,key:$e+"-select-orderby",type:"dropdown",options:X,onChange:d}))}if(o.order!==undefined){var Y=o.order;var Z=ic_blocks_js_global.order_options;w.push(Te(Qe,{label:ic_blocks_js_global.strings.select_order,value:Y,key:$e+"-select-order",type:"dropdown",options:Z,onChange:p}))}if(o.archive_template!==undefined){var $=o.archive_template;var ee=ic_blocks_js_global.template_options;w.push(Te(Qe,{label:ic_blocks_js_global.strings.select_template,value:$,key:$e+"-select-template",type:"dropdown",options:ee,onChange:f}))}if(o.per_row!==undefined){var te=o.per_row;w.push(Te(Fe,{label:ic_blocks_js_global.strings.select_perrow,value:te,key:$e+"-select-per-row",type:"number",onChange:g}))}if(o.no_add_to_cart!==undefined){var re=o.no_add_to_cart;if(ic_blocks_js_global.price_add_cart_added==="1"){w.push(Te(Ke,{key:$e+"-panel-body-row-noaddcart"},Te(ze,{label:ic_blocks_js_global.strings.disable_add_cart,checked:re,onChange:h})))}}if(e!==undefined){for(const[Ce,je]of Object.entries(e)){if(o[Ce]!==undefined){var ae=typeof o[Ce];if(ae==="boolean"){w.push(Te(Ke,{key:$e+"-panel-body-row-"+Ce},Te(ze,{label:je,checked:o[Ce],onChange:function(e){m(Ce,e)}})))}else if(ae==="string"){w.push(Te(Fe,{label:je,value:o[Ce],key:$e+"-"+Ce,type:"text",onChange:function(e){m(Ce,e)}}))}}}}if(o.alignment!==undefined){var le=o.alignment;A.push(Te(Ue,{value:le,key:$e+"-alignment",onChange:_}));j.textAlign=le}if(o.productSearch!==undefined&&o.selectedProduct!==undefined){var se=o.productSearch;var oe=tt(o);var ne=[];Ze=[];var ie=[];var ce=[];if(Array.isArray(oe)&&oe.length!==0||!Array.isArray(oe)&&oe){ie=P.selected_products;if(ie){if(Array.isArray(ie)){ie.forEach(e=>{if(e.value!==undefined){ce.push(parseInt(e.value,10));Ze.push({value:parseInt(e.value,10),label:Oe(e.label)})}else{ce.push(parseInt(e.id,10));Ze.push({value:parseInt(e.id,10),label:Oe(e.title.rendered)})}})}else{ce.push(parseInt(ie,10));Ze.push({value:parseInt(ie,10),label:"Loading..."})}}}ne=P.products;if(ne){ne.forEach(e=>{if(!ce.includes(parseInt(e.id,10))){Ze.push({value:parseInt(e.id,10),label:Oe(e.title.rendered)})}})}var ue=[Te(Ke,{key:$e+"-panel-body-row-product-search"},Te(Ge,{label:ic_blocks_js_global.strings.search_product,value:se,type:"string",key:$e+"-search-product",className:"ic-search-control",placeholder:ic_blocks_js_global.strings.search_placeholder,onChange:y}))];var de=[];var pe=[];var fe=[];var ge=[];var he=[];if(Array.isArray(oe)){Ze.forEach(t=>{fe.push(Te(Ke,{key:$e+"-checkbox-row-product-"+t.value},Te(ze,{label:t.label,checked:ce.includes(t.value),value:t.value,key:$e+"-checkbox-product-"+t.value,onChange:function(e){b(e,t.value,t.label)}})))})}else{fe.push(Te(Le,{label:"",selected:oe,key:$e+"-product",onChange:b,options:Ze}));if(o.productFromContext!==undefined){const xe=o.productFromContext?ic_blocks_js_global.strings.context_enabled_help:ic_blocks_js_global.strings.context_disabled_help;const Ie=Te(Je,{title:"",key:$e+"select-context-product-panel-body",className:"ic-panel-body",initialOpen:true},Te(Ke,{key:$e+"-panel-body-row-product-search-notice"},Te(qe,{label:ic_blocks_js_global.strings.get_product_from_context,checked:o.productFromContext,key:$e+"-product-from-context",help:xe,onChange:k})));if(o.productFromContext){ge.push(Ie);he.push(Ie)}else{de.push(Ie);pe.push(Ie)}}}var be=ic_blocks_js_global.strings.select_product;if(o.category!==undefined){be=ic_blocks_js_global.strings.by_product}else{const Pe=Ne.getBlockType(s.name);const Se=Pe.title;be=Se+" - "+be}var _e="ic-panel-body";var ye=0;if(ie){ye+=ie.length}if(ne){ye+=ne.length}if(!se&&(ye<10||ye===0)){_e="ic-hidden-panel-body"}if(ne===null||ne.length===0){if(P.ready){if(se){ue.push(Te(Ke,{key:$e+"-panel-body-row-product-search-notice"},Te(Me,{key:$e+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword.")))}}else{fe.push(Te(De,{key:$e+"product-selector-loading"}))}}de.push(Te(Je,{title:ic_blocks_js_global.strings.search_product,key:$e+"-search-products-panel-body",className:_e,initialOpen:true},ue));de.push(Te(Je,{title:ic_blocks_js_global.strings.select_product,key:$e+"select-product-panel-body",className:"ic-panel-body",initialOpen:true},fe));if(ge.length){de=ge}var ve=Te(He,{header:be,key:$e+"-search-products-block-panel"},de);pe.push(ue);pe.push(fe);if(he.length){pe=he}C.push(Te(Je,{title:ic_blocks_js_global.strings.select_product,key:$e+"-side-search-products-panel-body",className:"ic-panel-body",initialOpen:false},pe));if(Array.isArray(oe)&&oe.length===0){if(I.length===0){x=true}}else{x=false}I.push(ve)}if(I.length!==0){A.push(Te(Ve,{icon:"edit",key:$e+"-edit-button",title:ic_blocks_js_global.strings.edit_block,onClick:()=>i(!n),isActive:n||x}))}var ke=[Te(We,{key:$e+"-controls"},A)];var me=[];if(w.length){me.push(Te(Je,{title:ic_blocks_js_global.strings.options,key:$e+"-main-panel-body",className:"main-panel-body",initialOpen:true},w))}if(C.length){me.push(C)}if(me.length){ke.push(Te(Re,{key:"ic-price-field-table-block-controls"},me))}if(n||x){E=I;x=true;if(!n){i(true)}}var Ae="ic-block-output";if(x){Ae+="-edit"}var we={key:$e+"-div",className:Ae};if(!n){we.style=j;if(I.length!==0&&A.length<=1){we.onClick=()=>i(true)}}ke.push(Te("div",Xe(we),E));return ke},save:function(){return null}});function et(h){const e=window.wp.data.useSelect(e=>{const t=e("core");var r={};r.ready=true;if(h.selectedCategory!==undefined){var a=rt(h);var l={per_page:-1,_fields:"id,name,count",orderby:"term_group"};if(h.categorySearch!==undefined){var s=h.categorySearch;l.per_page=10;if(s){l.search=s;l.per_page=-1}}if(a.length!==0){var o=true;var n={per_page:-1,_fields:"id,name,count",orderby:"include",include:a.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{o=false;return parseInt(e,10)}})};r.selected_categories=t.getEntityRecords("taxonomy","al_product-cat",n);if(r.selected_categories===null&&o){r.selected_categories=a}else{}if(r.selected_categories===null){r.ready=false}else if(r.selected_categories.length>=l.per_page&&l.per_page>0){l.per_page=l.per_page+r.selected_categories.length}}r.categories=t.getEntityRecords("taxonomy","al_product-cat",l);if(r.categories===null){r.ready=false}}if(h.productSearch!==undefined&&h.selectedProduct!==undefined){var i=tt(h);var c=h.productSearch;var u={per_page:10,_fields:"id,title"};if(Array.isArray(i)&&i.length!==0||!Array.isArray(i)&&i){var d=true;var p={per_page:-1,_fields:"id,title",orderby:"include",include:Array.isArray(i)?i.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{d=false;return parseInt(e,10)}}):i};r.selected_products=t.getEntityRecords("postType","al_product",p);if(r.selected_products===null&&d){r.selected_products=i}else{}if(r.selected_products===null){r.ready=false}else if(r.selected_products.length>=u.per_page){u.per_page=u.per_page+r.selected_products.length}}if(c){u.search=c;u.per_page=100}r.products=t.getEntityRecords("postType","al_product",u);if(r.products===null){r.ready=false}}if(!r.ready){for(const[f,g]of Object.entries(r)){r[f]=null}}return r});return e}function tt(e){var t=e.selectedProduct;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.product.length){t=e.product.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedProduct,10)}return t}function rt(e){var t=e.selectedCategory;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.category.length){t=e.category.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedCategory,10)}return t}}jQuery(window).load(function(){jQuery(".ic-product-meta-field").each(function(){jQuery(this).on("change",function(){var e=jQuery(this).attr("name");var t={};t[e]=jQuery(this).val();wp.data.dispatch("core/editor").editPost({meta:t})})});wp.media.featuredImage.frame().on("select",function(){var e=wp.media.featuredImage.get();var t="_thumbnail_id";var r={};r[t]=e;wp.data.dispatch("core/editor").editPost({meta:r})});jQuery("#remove-post-thumbnail").on("click",function(){var e="_thumbnail_id";var t={};t[e]="";wp.data.dispatch("core/editor").editPost({meta:t})})});